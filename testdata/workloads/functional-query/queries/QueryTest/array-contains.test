====
---- QUERY
# Test array_contains with int array - element exists
select id, array_contains(int_array, 2) from complextypestbl where id=1
---- RESULTS
1,true
---- TYPES
bigint,boolean
====
---- QUERY
# Test array_contains with int array - element does not exist
select id, array_contains(int_array, 5) from complextypestbl where id=1
---- RESULTS
1,false
---- TYPES
bigint,boolean
====
---- QUERY
# Test array_contains with all rows
select id, array_contains(int_array, 1) from complextypestbl
---- RESULTS
1,true
2,true
3,false
4,NULL
5,NULL
6,NULL
7,NULL
8,false
---- TYPES
bigint,boolean
====
---- QUERY
# Test array_contains searching for NULL
select id, array_contains(int_array, cast(NULL as int)) from complextypestbl where id=2
---- RESULTS
2,NULL
---- TYPES
bigint,boolean
====
---- QUERY
# Test array_contains in WHERE clause
select id from complextypestbl where array_contains(int_array, 2)
---- RESULTS
1
2
---- TYPES
bigint
====
---- QUERY
# Test array_contains with multiple conditions
select id, array_contains(int_array, 1), array_contains(int_array, 2) 
from complextypestbl where id <= 2
---- RESULTS
1,true,true
2,true,true
---- TYPES
bigint,boolean,boolean
====
---- QUERY
# Test array_contains with JOIN
select t1.id, array_contains(t1.int_array, 1), array_contains(t2.int_array, 2)
from complextypestbl t1 join complextypestbl t2 on t1.id = t2.id
where t1.id = 1
---- RESULTS
1,true,true
---- TYPES
bigint,boolean,boolean
====
---- QUERY
# Test array_contains with UNION ALL
select id, array_contains(int_array, 1) from complextypestbl where id=1
union all
select id, array_contains(int_array, 2) from complextypestbl where id=2
---- RESULTS
1,true
2,true
---- TYPES
bigint,boolean
====
---- QUERY
# Test array_contains with aggregation
select count(*) from complextypestbl where array_contains(int_array, 1)
---- RESULTS
2
---- TYPES
bigint
====
---- QUERY
# Test array_contains with GROUP BY
select array_contains(int_array, 1) as contains_one, count(*) 
from complextypestbl 
group by array_contains(int_array, 1)
---- RESULTS
false,2
true,2
NULL,4
---- TYPES
boolean,bigint
====
---- QUERY
# Test array_contains with ORDER BY
select id, array_contains(int_array, 1) as contains_one
from complextypestbl 
where id <= 3
order by contains_one, id
---- RESULTS
3,false
1,true
2,true
---- TYPES
bigint,boolean
====
---- QUERY
# Test array_contains with subquery
select id from complextypestbl t
where array_contains(int_array, 1) = true
---- RESULTS
1
2
---- TYPES
bigint
====
---- QUERY
# Test array_contains with CASE expression
select id, 
  case when array_contains(int_array, 1) then 'contains 1'
       when array_contains(int_array, 2) then 'contains 2'
       else 'neither'
  end as result
from complextypestbl where id <= 3
---- RESULTS
1,'contains 1'
2,'contains 1'
3,'neither'
---- TYPES
bigint,string
====
